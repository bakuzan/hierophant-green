{"version":3,"sources":["webpack:///../lib/groupBy.ts","webpack:///./src/components/PageAnchor.js","webpack:///./src/components/Honours/utils.js","webpack:///./src/components/Honours/SeasonSection.js","webpack:///./src/components/Honours/StandoutSection.js","webpack:///./src/components/Honours/YearSection.js","webpack:///./src/pages/honours.js","webpack:///./node_modules/core-js/modules/es6.string.link.js"],"names":["key","PageAnchor","id","props","style","margin","href","Icons","link","displayName","selectTop","items","opts","n","top","hide","hideCarryOvers","includeUserSettingFilters","item","hasMinEpisodes","minEpisodes","noEnding","totalEpisodes","wontFinish","Math","max","episodes","map","x","episode","isCarryOver","slice","orderStandoutEpisodes","a","b","av","rating","bv","ad","bd","title","localeCompare","SeasonSection","slug","sectionId","replace","rows","averageRatedTotal","series","average","ratedCount","console","log","rhythm","display","alignItems","to","textDecoration","color","className","capitalise","isNaN","HGTable","hideSeason","standoutHeaders","text","textAlign","StandoutSection","standOutRating","storage","getKey","standOutSectionId","length","Table","headers","sort","i","number","season","year","episodeId","column-title","flexDirection","justifyContent","fontSize","flex","image","childImageSharp","malId","YearSection","yearOrSeasonName","isYear","mounted","useMountedOnClient","useState","setHideCarryOvers","seasonCount","hasAllSeasons","hideCarryOversId","seasons","generateSeriesStatistics","getSeasonName","seriesSorter","allSeries","reduceNestedList","allEpisodes","allSeasons","standOutEpisodes","filter","data","find","s","animeId","itemSeason","padding","name","checked","onChange","e","p","Fragment","entry","hideRatingColumn","allDataJson","nodes","groups","groupBy","split","years","Array","from","entries","query","createHTML","url","this"],"mappings":"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","file":"component---src-pages-honours-js-4a2486c9c000df269215.js","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = groupBy;\n\nfunction groupBy(list) {\n  var keyGetter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function (x) {\n    return x;\n  };\n  var map = new Map();\n  list.forEach(function (item) {\n    var key = keyGetter(item);\n    var collection = map.get(key);\n\n    if (!collection) {\n      map.set(key, [item]);\n    } else {\n      collection.push(item);\n    }\n  });\n  return map;\n}\n//# sourceMappingURL=groupBy.js.map","import PropTypes from 'prop-types';\r\nimport React from 'react';\r\n\r\nimport Icons from 'meiko/constants/icons';\r\n\r\nfunction PageAnchor({ id, ...props }) {\r\n  return (\r\n    <a {...props} style={{ margin: `0 10px` }} href={`#${id}`}>\r\n      {Icons.link}\r\n    </a>\r\n  );\r\n}\r\n\r\nPageAnchor.displayName = 'PageAnchor';\r\nPageAnchor.propTypes = {\r\n  id: PropTypes.string.isRequired\r\n};\r\n\r\nexport default PageAnchor;\r\n","import includeUserSettingFilters from '@/utils/includeUserSettingFilters';\r\n\r\nexport function selectTop(items, opts) {\r\n  const n = opts.top ?? 3;\r\n  const hide = opts.hideCarryOvers ?? false;\r\n\r\n  const filtered = includeUserSettingFilters(\r\n    items,\r\n    (item, hasMinEpisodes, minEpisodes) => {\r\n      const noEnding = item.totalEpisodes === 0;\r\n      const wontFinish =\r\n        minEpisodes <=\r\n        item.totalEpisodes - Math.max(...item.episodes.map((x) => x.episode));\r\n\r\n      return (\r\n        !item.isCarryOver ||\r\n        (!hide && (hasMinEpisodes || noEnding || wontFinish))\r\n      );\r\n    }\r\n  );\r\n\r\n  return filtered.slice(0, n);\r\n}\r\n\r\nexport function orderStandoutEpisodes(a, b) {\r\n  const av = a.episode.rating;\r\n  const bv = b.episode.rating;\r\n\r\n  if (av < bv) {\r\n    return 1;\r\n  }\r\n\r\n  if (av > bv) {\r\n    return -1;\r\n  }\r\n\r\n  const ad = av - a.rating;\r\n  const bd = bv - b.rating;\r\n\r\n  if (ad < bd) {\r\n    return 1;\r\n  }\r\n\r\n  if (ad > bd) {\r\n    return -1;\r\n  }\r\n\r\n  return a.title.localeCompare(b.title);\r\n}\r\n\r\nexport function generateSeriesForEpisode(yearOrSeasonName, series, episodes) {\r\n  const isYear = yearOrSeasonName.length === 4;\r\n\r\n  return episodes.map((x) => {\r\n    const data = series.find((s) => s.id === x.animeId);\r\n    const itemSeason = isYear\r\n      ? `${data.season.year}`\r\n      : `${data.season.season} ${data.season.year}`;\r\n\r\n    return {\r\n      ...data,\r\n      episodeId: x.id,\r\n      episode: x,\r\n      isCarryOver: itemSeason !== yearOrSeasonName\r\n    };\r\n  });\r\n}\r\n","import PropTypes from 'prop-types';\r\nimport React from 'react';\r\nimport { Link } from 'gatsby';\r\n\r\nimport { capitalise } from 'ayaka/capitalise';\r\n\r\nimport HGTable from '@/components/Table/HGTable';\r\nimport PageAnchor from '@/components/PageAnchor';\r\n\r\nimport averageRatedTotal from '@/utils/averageRatedTotal';\r\nimport { rhythm } from '@/utils/typography';\r\nimport { selectTop } from './utils';\r\n\r\nfunction SeasonSection({ slug, title, hideCarryOvers, items, ...props }) {\r\n  const sectionId = `section_${slug.replace(/\\//g, '')}`;\r\n  const rows = selectTop(items, { top: 3, hideCarryOvers });\r\n  const { average, ratedCount } = averageRatedTotal({ series: items });\r\n  console.log('Season : ', slug, title);\r\n  console.log('Items > ', items, rows);\r\n  return (\r\n    <section id={sectionId} style={{ margin: `${rhythm(1)} 0` }}>\r\n      <header style={{ display: 'flex', alignItems: 'center' }}>\r\n        <PageAnchor id={sectionId} />\r\n        <Link\r\n          to={slug}\r\n          style={{\r\n            textDecoration: 'none',\r\n            color: 'inherit'\r\n          }}\r\n        >\r\n          <h4 className=\"season-link\" style={{ margin: `${rhythm(3 / 4)} 0` }}>\r\n            {capitalise(title)}\r\n          </h4>\r\n        </Link>\r\n      </header>\r\n      <p>\r\n        {isNaN(average)\r\n          ? `Average rating unavailable`\r\n          : `Average: ${average} for ${ratedCount} rated series`}\r\n      </p>\r\n      <HGTable hideSeason {...props} items={rows} />\r\n    </section>\r\n  );\r\n}\r\n\r\nSeasonSection.propTypes = {\r\n  slug: PropTypes.string.isRequired,\r\n  title: PropTypes.string.isRequired,\r\n  hideCarryOvers: PropTypes.bool.isRequired,\r\n  items: PropTypes.arrayOf(PropTypes.object).isRequired\r\n};\r\n\r\nexport default SeasonSection;\r\n","import PropTypes from 'prop-types';\r\nimport React from 'react';\r\nimport Img from 'gatsby-image';\r\n\r\nimport NewTabLink from 'meiko/NewTabLink';\r\n\r\nimport Table from '@/components/Table';\r\nimport PageAnchor from '@/components/PageAnchor';\r\n\r\nimport storage from '@/utils/storage';\r\nimport { rhythm } from '@/utils/typography';\r\nimport { orderStandoutEpisodes } from './utils';\r\n\r\nconst standoutHeaders = [\r\n  { text: '#', style: { textAlign: 'right' } },\r\n  { text: 'Title' },\r\n  { text: 'Episode Rating', style: { textAlign: 'right' } },\r\n  { text: 'Rating difference', style: { textAlign: 'right' } }\r\n];\r\n\r\nfunction StandoutSection({ sectionId, items }) {\r\n  const standOutRating = storage.getKey('standoutEpisodeRating');\r\n  const standOutSectionId = `${sectionId}_standout`;\r\n\r\n  return (\r\n    <section id={standOutSectionId} style={{ margin: `${rhythm(1)} 0` }}>\r\n      <header style={{ display: 'flex', alignItems: 'center' }}>\r\n        <PageAnchor id={standOutSectionId} />\r\n        <h4\r\n          className=\"season-link season-link--no-hover\"\r\n          style={{ margin: `${rhythm(3 / 4)} 0` }}\r\n        >\r\n          Standout episodes of the year\r\n        </h4>\r\n      </header>\r\n      <p>\r\n        The top 5 episodes rating in at {standOutRating} or above.\r\n        <br /> Ordered by rating desc, rating difference to overall series\r\n        rating desc, and title asc.\r\n      </p>\r\n      {items.length ? (\r\n        <Table headers={standoutHeaders}>\r\n          {() =>\r\n            items\r\n              .sort(orderStandoutEpisodes)\r\n              .slice(0, 5)\r\n              .map((x, i) => {\r\n                const number = i + 1;\r\n                const season = `${x.season.season} ${x.season.year}`;\r\n\r\n                return (\r\n                  <tr key={x.episodeId}>\r\n                    <td column-title=\"#\" className=\"cell cell--rhs\">\r\n                      <div\r\n                        style={{\r\n                          display: 'flex',\r\n                          flexDirection: 'column',\r\n                          justifyContent: 'space-between'\r\n                        }}\r\n                      >\r\n                        <div>{number}</div>\r\n                        <div style={{ fontSize: `0.75rem` }}>{season}</div>\r\n                      </div>\r\n                    </td>\r\n                    <td column-title=\"Title\" className=\"cell\">\r\n                      <div style={{ display: 'flex' }}>\r\n                        <Img\r\n                          style={{ flex: `0 0 96px` }}\r\n                          {...x.image.childImageSharp}\r\n                        />\r\n                        <div style={{ margin: `0 ${rhythm(1 / 2)}` }}>\r\n                          <NewTabLink\r\n                            style={{\r\n                              display: 'flex',\r\n                              justifyContent: 'flex-start'\r\n                            }}\r\n                            href={`https://myanimelist.net/anime/${x.malId}`}\r\n                          >\r\n                            {x.title}\r\n                          </NewTabLink>\r\n                          <div style={{ fontSize: `0.75rem` }}>\r\n                            Episode {x.episode.episode}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </td>\r\n                    <td\r\n                      column-title=\"Episode Rating\"\r\n                      className=\"cell cell--rhs\"\r\n                    >\r\n                      {x.episode.rating}\r\n                    </td>\r\n                    <td\r\n                      column-title=\"Rating Difference\"\r\n                      className=\"cell cell--rhs\"\r\n                    >\r\n                      {x.episode.rating - x.rating}\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })\r\n          }\r\n        </Table>\r\n      ) : (\r\n        <div>This year saw no stand out episodes.</div>\r\n      )}\r\n    </section>\r\n  );\r\n}\r\n\r\nStandoutSection.propTypes = {\r\n  sectionId: PropTypes.string.isRequired,\r\n  items: PropTypes.arrayOf(PropTypes.object).isRequired\r\n};\r\n\r\nexport default StandoutSection;\r\n","import PropTypes from 'prop-types';\r\nimport React, { useState } from 'react';\r\nimport { Link } from 'gatsby';\r\n\r\nimport Tickbox from 'meiko/Tickbox';\r\n\r\nimport HGTable from '@/components/Table/HGTable';\r\nimport PageAnchor from '@/components/PageAnchor';\r\nimport SeasonSection from './SeasonSection';\r\nimport StandoutSection from './StandoutSection';\r\n\r\nimport { useMountedOnClient } from '@/hooks/useMountedOnClient';\r\nimport storage from '@/utils/storage';\r\nimport seriesSorter from '@/utils/seriesSorter';\r\nimport reduceNestedList from '@/utils/reduceNestedList';\r\nimport averageRatedTotal from '@/utils/averageRatedTotal';\r\nimport generateSeriesStatistics from '@/utils/generateSeriesStatistics';\r\nimport getSeasonName from '@/utils/getSeasonName';\r\nimport { rhythm } from '@/utils/typography';\r\nimport { selectTop, generateSeriesForEpisode } from './utils';\r\n\r\nfunction YearSection({ title, items }) {\r\n  const mounted = useMountedOnClient();\r\n  const [hideCarryOvers, setHideCarryOvers] = useState(false);\r\n\r\n  const sectionId = `section_${title}`;\r\n  const seasonCount = items.length;\r\n  const hasAllSeasons = seasonCount === 4;\r\n  const hideCarryOversId = `hideCarryOvers_${title}`;\r\n\r\n  const seasons = items.map((x) => ({\r\n    season: x.season,\r\n    items: generateSeriesStatistics(\r\n      getSeasonName(x.season),\r\n      x.series,\r\n      x.episodes\r\n    ).sort(seriesSorter)\r\n  }));\r\n\r\n  const allSeries = reduceNestedList(items, 'series');\r\n  const allEpisodes = reduceNestedList(items, 'episodes');\r\n  const allSeasons = generateSeriesStatistics(\r\n    title,\r\n    allSeries,\r\n    allEpisodes\r\n  ).sort(seriesSorter);\r\n\r\n  const { average, ratedCount } = averageRatedTotal({ series: allSeasons });\r\n\r\n  const standOutRating = storage.getKey('standoutEpisodeRating');\r\n  const standOutEpisodes = generateSeriesForEpisode(\r\n    title,\r\n    allSeries,\r\n    allEpisodes.filter((x) => x.rating >= standOutRating)\r\n  ).filter((x) => !x.isCarryOver || !hideCarryOvers);\r\n\r\n  return (\r\n    <section\r\n      id={sectionId}\r\n      style={{\r\n        padding: `0 ${rhythm(3 / 4)} ${rhythm(1 / 8)}`,\r\n        margin: `${rhythm(1)} 0`\r\n      }}\r\n    >\r\n      <header\r\n        style={{\r\n          display: 'flex',\r\n          alignItems: 'center'\r\n        }}\r\n      >\r\n        <PageAnchor id={sectionId} />\r\n        <Link\r\n          to={`/${title}/`}\r\n          style={{\r\n            textDecoration: 'none',\r\n            color: 'inherit'\r\n          }}\r\n        >\r\n          <h3 className=\"season-link\" style={{ margin: `${rhythm(3 / 4)} 0` }}>\r\n            {title}\r\n            {hasAllSeasons ? ' - Overview' : ''}\r\n          </h3>\r\n        </Link>\r\n        <div className=\"flex-spacer\"></div>\r\n        {mounted && (\r\n          <div>\r\n            <Tickbox\r\n              className=\"hide-carry-overs\"\r\n              id={hideCarryOversId}\r\n              name={hideCarryOversId}\r\n              checked={hideCarryOvers}\r\n              text={' Hide carry overs'}\r\n              onChange={(e) => setHideCarryOvers((p) => !p)}\r\n            />\r\n          </div>\r\n        )}\r\n      </header>\r\n\r\n      <p>\r\n        {isNaN(average)\r\n          ? `Average rating unavailable`\r\n          : `Average: ${average} for ${ratedCount} rated series`}\r\n      </p>\r\n\r\n      {!hasAllSeasons && (\r\n        <p>\r\n          Once all seasons for the year are available, a top 5 ranking for the\r\n          year table will be displayed.\r\n          <br /> Below are top 3 rankings for each season in {title}. <br />\r\n          Unfinished seasons will not display the overall rating column.\r\n        </p>\r\n      )}\r\n      {hasAllSeasons && (\r\n        <React.Fragment>\r\n          <p>\r\n            Below is a top 5 ranking for the year of {title}.\r\n            <br />\r\n            Following that each individual season for {title} has a top 3\r\n            ranking.\r\n          </p>\r\n          <HGTable items={selectTop(allSeasons, { top: 5, hideCarryOvers })} />\r\n        </React.Fragment>\r\n      )}\r\n\r\n      {seasons.map((entry, i) => {\r\n        const name = getSeasonName(entry.season, false);\r\n        return (\r\n          <SeasonSection\r\n            key={entry.season}\r\n            slug={`/${entry.season}/`}\r\n            title={`${name} ${title}`}\r\n            items={entry.items}\r\n            hideCarryOvers={hideCarryOvers}\r\n            hideRatingColumn={i + 1 >= seasonCount}\r\n          />\r\n        );\r\n      })}\r\n\r\n      {hasAllSeasons && (\r\n        <StandoutSection sectionId={sectionId} items={standOutEpisodes} />\r\n      )}\r\n    </section>\r\n  );\r\n}\r\n\r\nYearSection.propTypes = {\r\n  title: PropTypes.string.isRequired,\r\n  items: PropTypes.arrayOf(PropTypes.object).isRequired\r\n};\r\n\r\nexport default YearSection;\r\n","import React from 'react';\r\nimport { graphql } from 'gatsby';\r\n\r\nimport groupBy from 'ayaka/groupBy';\r\n\r\nimport Layout from '@/components/AppLayout';\r\nimport SEO from '@/components/AppSEO';\r\nimport YearSection from '@/components/Honours/YearSection';\r\n\r\nexport default ({ data }) => {\r\n  const seasons = data.allDataJson.nodes ?? [];\r\n  const groups = groupBy(seasons, (x) => x.season.split('-')[0]);\r\n  const years = Array.from(groups.entries());\r\n\r\n  return (\r\n    <Layout>\r\n      <SEO title=\"Honours\" />\r\n      <div>\r\n        <header>\r\n          <h2>Honours</h2>\r\n        </header>\r\n        <p>\r\n          Below are the best series of each season that currently has data on\r\n          the site.\r\n          <br /> These are automated based on the on the sort order of average\r\n          desc, rating desc, mode desc, and title asc.\r\n        </p>\r\n        {years.map(([year, items]) => (\r\n          <YearSection key={year} title={year} items={items} />\r\n        ))}\r\n      </div>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport const query = graphql`\r\n  query {\r\n    allDataJson(sort: { order: DESC, fields: season }) {\r\n      nodes {\r\n        season\r\n        series {\r\n          id\r\n          title\r\n          image {\r\n            childImageSharp {\r\n              fixed(width: 96, height: 150) {\r\n                ...GatsbyImageSharpFixed\r\n              }\r\n            }\r\n          }\r\n          malId\r\n          rating\r\n          totalEpisodes\r\n          season {\r\n            year\r\n            season\r\n          }\r\n        }\r\n        episodes {\r\n          id\r\n          date\r\n          episode\r\n          rating\r\n          animeId\r\n        }\r\n      }\r\n    }\r\n  }\r\n`;\r\n","'use strict';\n// B.2.3.10 String.prototype.link(url)\nrequire('./_string-html')('link', function (createHTML) {\n  return function link(url) {\n    return createHTML(this, 'a', 'href', url);\n  };\n});\n"],"sourceRoot":""}